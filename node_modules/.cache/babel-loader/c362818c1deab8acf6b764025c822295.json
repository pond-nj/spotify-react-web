{"ast":null,"code":"import SearchBar from \"../Components/SearchBar/SearchBar\";\nconst clientID = 'a8f8fad42f0e45568722c012700162ed';\nconst redirectURL = 'http://localhost:3000/';\nlet accessToken;\nconst Spotify = {\n  getAccessToken() {\n    if (accessToken) {\n      return accessToken;\n    } else {\n      //check for Token in URL\n      const accessTokenMatch = window.location.href.match(/access_token=([^&]*)/);\n      const expiresInMatch = window.location.href.match(/expires_in=([^&]*)/);\n\n      if (accessTokenMatch && expiresInMatch) {\n        accessToken = accessTokenMatch[1];\n        const expiresIn = Number(expiresInMatch[1]); //clear parameters\n\n        window.setTimeout(() => {\n          accessToken = \"\";\n        }, expiresIn * 1000);\n        window.history.pushState('Access Token', null, '/');\n        return accessToken;\n      } else {\n        //accessToken is empty and is not in URL\n        const accessURL = `https://accounts.spotify.com/authorize?client_id=${clientID}&response_type=token&scope=playlist-modify-public&redirect_uri=${redirectURL}`;\n        window.location = accessURL;\n      }\n    }\n  },\n\n  search(term) {\n    const accessToken = Spotify.getAccessToken();\n    return fetch(`https://api.spotify.com/v1/search?type=track&q=${term}`, {\n      headers: {\n        Authorization: `Bearer ${accessToken}`\n      }\n    }).then(response => {\n      return response.json();\n    }).then(jsonResponse => {\n      if (!jsonResponse.tracks) {\n        return [];\n      } else {\n        return jsonResponse.tracks.items.map(track => {\n          return {\n            id: track.id,\n            name: track.name,\n            artists: track.artists[0].name,\n            albun: track.album.name,\n            uri: track.uri\n          };\n        });\n      }\n    });\n  },\n\n  savePlaylist(playlistName, tracksURI) {\n    if (!playlistName && !tracksURI) {\n      return;\n    } else {}\n  }\n\n};\nexport default Spotify;","map":{"version":3,"sources":["/Users/nutdranai.jaruthikorn/Desktop/JsProject/jammming/src/util/Spotify.js"],"names":["SearchBar","clientID","redirectURL","accessToken","Spotify","getAccessToken","accessTokenMatch","window","location","href","match","expiresInMatch","expiresIn","Number","setTimeout","history","pushState","accessURL","search","term","fetch","headers","Authorization","then","response","json","jsonResponse","tracks","items","map","track","id","name","artists","albun","album","uri","savePlaylist","playlistName","tracksURI"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,mCAAtB;AAEA,MAAMC,QAAQ,GAAG,kCAAjB;AACA,MAAMC,WAAW,GAAG,wBAApB;AACA,IAAIC,WAAJ;AAEA,MAAMC,OAAO,GAAG;AAEZC,EAAAA,cAAc,GAAE;AACZ,QAAIF,WAAJ,EAAiB;AACb,aAAOA,WAAP;AACH,KAFD,MAEK;AAED;AACA,YAAMG,gBAAgB,GAAGC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAqBC,KAArB,CAA2B,sBAA3B,CAAzB;AACA,YAAMC,cAAc,GAAGJ,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAqBC,KAArB,CAA2B,oBAA3B,CAAvB;;AAEA,UAAIJ,gBAAgB,IAAIK,cAAxB,EAAwC;AACpCR,QAAAA,WAAW,GAAGG,gBAAgB,CAAC,CAAD,CAA9B;AACA,cAAMM,SAAS,GAAGC,MAAM,CAACF,cAAc,CAAC,CAAD,CAAf,CAAxB,CAFoC,CAIpC;;AAEAJ,QAAAA,MAAM,CAACO,UAAP,CAAmB,MAAM;AAAEX,UAAAA,WAAW,GAAG,EAAd;AAAkB,SAA7C,EAA+CS,SAAS,GAAG,IAA3D;AACAL,QAAAA,MAAM,CAACQ,OAAP,CAAeC,SAAf,CAAyB,cAAzB,EAAyC,IAAzC,EAA+C,GAA/C;AACA,eAAOb,WAAP;AACH,OATD,MASO;AACH;AACA,cAAMc,SAAS,GAAI,oDAAmDhB,QAAS,kEAAiEC,WAAY,EAA5J;AACAK,QAAAA,MAAM,CAACC,QAAP,GAAkBS,SAAlB;AACH;AACJ;AACJ,GA1BW;;AA4BZC,EAAAA,MAAM,CAAEC,IAAF,EAAQ;AACV,UAAMhB,WAAW,GAAGC,OAAO,CAACC,cAAR,EAApB;AACA,WAAOe,KAAK,CAAG,kDAAiDD,IAAK,EAAzD,EAA4D;AACpEE,MAAAA,OAAO,EAAC;AAAEC,QAAAA,aAAa,EAAG,UAASnB,WAAY;AAAvC;AAD4D,KAA5D,CAAL,CAEJoB,IAFI,CAEGC,QAAD,IAAc;AACnB,aAAOA,QAAQ,CAACC,IAAT,EAAP;AACH,KAJM,EAIJF,IAJI,CAIEG,YAAY,IAAI;AACrB,UAAI,CAACA,YAAY,CAACC,MAAlB,EAA0B;AACtB,eAAO,EAAP;AACH,OAFD,MAEO;AACH,eAAOD,YAAY,CAACC,MAAb,CAAoBC,KAApB,CAA0BC,GAA1B,CAA+BC,KAAK,IAAI;AAC3C,iBAAO;AACHC,YAAAA,EAAE,EAAED,KAAK,CAACC,EADP;AAEHC,YAAAA,IAAI,EAAEF,KAAK,CAACE,IAFT;AAGHC,YAAAA,OAAO,EAAEH,KAAK,CAACG,OAAN,CAAc,CAAd,EAAiBD,IAHvB;AAIHE,YAAAA,KAAK,EAAEJ,KAAK,CAACK,KAAN,CAAYH,IAJhB;AAKHI,YAAAA,GAAG,EAAEN,KAAK,CAACM;AALR,WAAP;AAOH,SARM,CAAP;AASH;AAEJ,KAnBM,CAAP;AAqBH,GAnDW;;AAqDZC,EAAAA,YAAY,CAAEC,YAAF,EAAiBC,SAAjB,EAA4B;AACpC,QAAI,CAACD,YAAD,IAAiB,CAACC,SAAtB,EAAiC;AAC7B;AACH,KAFD,MAEM,CAEL;AACJ;;AA3DW,CAAhB;AA+DA,eAAenC,OAAf","sourcesContent":["import SearchBar from \"../Components/SearchBar/SearchBar\";\n\nconst clientID = 'a8f8fad42f0e45568722c012700162ed';\nconst redirectURL = 'http://localhost:3000/';\nlet accessToken;\n\nconst Spotify = {\n\n    getAccessToken(){\n        if( accessToken ){\n            return accessToken;\n        }else{\n\n            //check for Token in URL\n            const accessTokenMatch = window.location.href.match(/access_token=([^&]*)/);\n            const expiresInMatch = window.location.href.match(/expires_in=([^&]*)/);\n\n            if( accessTokenMatch && expiresInMatch ){\n                accessToken = accessTokenMatch[1];\n                const expiresIn = Number(expiresInMatch[1]);\n\n                //clear parameters\n\n                window.setTimeout( () => { accessToken = \"\" }, expiresIn * 1000 );\n                window.history.pushState('Access Token', null, '/');\n                return accessToken;\n            } else {\n                //accessToken is empty and is not in URL\n                const accessURL = `https://accounts.spotify.com/authorize?client_id=${clientID}&response_type=token&scope=playlist-modify-public&redirect_uri=${redirectURL}`;\n                window.location = accessURL;\n            }\n        }\n    },\n    \n    search( term ){\n        const accessToken = Spotify.getAccessToken();\n        return fetch( `https://api.spotify.com/v1/search?type=track&q=${term}`, {\n            headers:{ Authorization: `Bearer ${accessToken}` }\n        }).then( (response) => {\n            return response.json();\n        }).then( jsonResponse => {\n            if( !jsonResponse.tracks ){\n                return [];\n            } else {\n                return jsonResponse.tracks.items.map( track => {\n                    return {\n                        id: track.id,\n                        name: track.name,\n                        artists: track.artists[0].name,\n                        albun: track.album.name,\n                        uri: track.uri,\n                    };\n                });\n            }\n\n        });\n\n    },\n\n    savePlaylist( playlistName , tracksURI ){\n        if( !playlistName && !tracksURI ){\n            return;\n        }else {\n            \n        }\n    }\n\n};\n\nexport default Spotify;"]},"metadata":{},"sourceType":"module"}