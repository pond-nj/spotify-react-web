{"ast":null,"code":"const clientID = 'a8f8fad42f0e45568722c012700162ed';\nconst redirectURL = 'http://localhost:3000/';\nlet accessToken;\nconst Spotify = {\n  getAccessToken() {\n    if (accessToken) {\n      return accessToken;\n    } else {\n      //check for Token in URL\n      const accessTokenMatch = window.location.href.match(/access_token=([^&]*)/);\n      const expiresInMatch = window.location.href.match(/expires_in=([^&]*)/);\n\n      if (accessTokenMatch && expiresInMatch) {\n        accessToken = accessTokenMatch[1];\n        const expiresIn = Number(expiresInMatch[1]); //clear parameters\n\n        window.setTimeout(() => accessToken = \"\", expiresIn * 1000);\n        window.history.pushState('Access Token', null, '/');\n        return accessToken;\n      } else {\n        //accessToken is empty and is not in URL\n        console.log('accessToken is empty');\n        const accessURL = `https://accounts.spotify.com/authorize?client_id=${clientID}&response_type=token&scope=playlist-modify-public&redirect_uri=${redirectURL}`;\n        window.location = accessURL;\n      }\n    }\n  },\n\n  search(term) {\n    const accessToken = Spotify.getAccessToken(); //console.log( `term: ${term}`);\n\n    return fetch(`https://api.spotify.com/v1/search?type=track&q=${term}`, {\n      headers: {\n        Authorization: `Bearer ${accessToken}`\n      }\n    }).then(response => {\n      //console.log(response);\n      return response.json();\n    }).then(jsonResponse => {\n      //console.log( jsonResponse );\n      if (!jsonResponse.tracks) {\n        return [{\n          id: \"none\",\n          name: \"none\",\n          artists: \"none\",\n          albun: \"none\",\n          uri: \"none\"\n        }];\n      } else {\n        return jsonResponse.tracks.items.map(track => {\n          return {\n            id: track.id,\n            name: track.name,\n            artists: track.artists[0].name,\n            albun: track.album.name,\n            uri: track.uri\n          };\n        });\n      }\n    });\n  },\n\n  savePlaylist(playlistName, tracksURI) {\n    if (!playlistName || !tracksURI) {\n      return;\n    } else {\n      const accessToken = Spotify.getAccessToken();\n      const headers = {\n        Authorization: `Bearer ${accessToken}`\n      };\n      let userID;\n      fetch('https://api.spotify.com/v1/me', {\n        headers: headers\n      }).then(response => response.json()).then(jsonResponse => {\n        userID = jsonResponse.id;\n        fetch(`https://api.spotify.com/v1/users/${userID}/playlists`, {\n          headers: headers,\n          method: 'POST',\n          body: JSON.stringify({\n            name: playlistName,\n            description: \"react-jammming project\",\n            public: false\n          })\n        }).then(response => response.json()).then(jsonResponse => {\n          const playlistID = jsonResponse.id;\n          return fetch(`https://api.spotify.com/v1/playlists/${playlistID}/tracks`, {\n            headers: headers,\n            method: 'POST',\n            body: JSON.stringify({\n              uris: tracksURI\n            })\n          }).then(response => {\n            console.log(response);\n          });\n        });\n      });\n    }\n  }\n\n};\nexport default Spotify;","map":{"version":3,"sources":["/Users/nutdranai.jaruthikorn/Desktop/JsProject/jammming/src/util/Spotify.js"],"names":["clientID","redirectURL","accessToken","Spotify","getAccessToken","accessTokenMatch","window","location","href","match","expiresInMatch","expiresIn","Number","setTimeout","history","pushState","console","log","accessURL","search","term","fetch","headers","Authorization","then","response","json","jsonResponse","tracks","id","name","artists","albun","uri","items","map","track","album","savePlaylist","playlistName","tracksURI","userID","method","body","JSON","stringify","description","public","playlistID","uris"],"mappings":"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","sourcesContent":["const clientID = 'a8f8fad42f0e45568722c012700162ed';\nconst redirectURL = 'http://localhost:3000/';\nlet accessToken;\n\nconst Spotify = {\n\n    getAccessToken(){\n        \n\n        if( accessToken ){\n            return accessToken;\n        }else{\n            \n            //check for Token in URL\n            const accessTokenMatch = window.location.href.match(/access_token=([^&]*)/);\n            const expiresInMatch = window.location.href.match(/expires_in=([^&]*)/);\n\n            if( accessTokenMatch && expiresInMatch ){\n                accessToken = accessTokenMatch[1];\n                const expiresIn = Number(expiresInMatch[1]);\n\n                //clear parameters\n\n                window.setTimeout( () => accessToken = \"\" , expiresIn * 1000 );\n                window.history.pushState('Access Token', null, '/');\n                return accessToken;\n            } else {\n                //accessToken is empty and is not in URL\n                console.log( 'accessToken is empty' );\n                const accessURL = `https://accounts.spotify.com/authorize?client_id=${clientID}&response_type=token&scope=playlist-modify-public&redirect_uri=${redirectURL}`;\n                window.location = accessURL;\n            }\n        }\n    },\n    \n    search( term ){\n        const accessToken = Spotify.getAccessToken();\n        //console.log( `term: ${term}`);\n        return fetch( `https://api.spotify.com/v1/search?type=track&q=${term}`, {\n            headers:{ Authorization: `Bearer ${accessToken}` }\n        }).then( (response) => {\n            //console.log(response);\n            return response.json();\n        }).then( jsonResponse => {\n            //console.log( jsonResponse );\n            if( !jsonResponse.tracks ){\n                return [{\n                    id:\"none\",\n                    name:\"none\",\n                    artists:\"none\",\n                    albun:\"none\",\n                    uri:\"none\"\n                }];\n            } else {\n                return jsonResponse.tracks.items.map( track => {\n                    return {\n                        id: track.id,\n                        name: track.name,\n                        artists: track.artists[0].name,\n                        albun: track.album.name,\n                        uri: track.uri,\n                    };\n                });\n            }\n\n        });\n\n    },\n\n    savePlaylist( playlistName , tracksURI ){\n        if( !playlistName || !tracksURI ){\n            return;\n        }else {\n            const accessToken = Spotify.getAccessToken();\n            const headers = {\n                Authorization: `Bearer ${accessToken}`\n            };\n            let userID;\n\n            fetch( 'https://api.spotify.com/v1/me' , {headers: headers}\n            ).then( response => response.json()\n            ).then( jsonResponse => {\n                userID = jsonResponse.id;\n                fetch( `https://api.spotify.com/v1/users/${userID}/playlists`, {\n                    headers: headers,\n                    method: 'POST',\n                    body: JSON.stringify({ name: playlistName, description: \"react-jammming project\", public: false })\n                }).then( response => response.json()\n                ).then( jsonResponse => {\n                    const playlistID = jsonResponse.id;\n                    return fetch( `https://api.spotify.com/v1/playlists/${playlistID}/tracks` , {\n                        headers: headers,\n                        method: 'POST',\n                        body: JSON.stringify( {uris: tracksURI })\n                    }).then( response => { console.log( response )} );\n                });\n\n            }\n            );\n\n        }\n    }\n}\n\nexport default Spotify;"]},"metadata":{},"sourceType":"module"}